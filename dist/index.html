<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Quiz HÃ¡n tá»± - Pinyin | Há»c tiáº¿ng Trung hiá»‡u quáº£</title>
    <meta
      name="description"
      content="á»¨ng dá»¥ng há»c tiáº¿ng Trung vá»›i quiz HÃ¡n tá»± - Pinyin vÃ  luyá»‡n nÃ³i. Há»— trá»£ HSK 1-3 vÃ  cháº¿ Ä‘á»™ luyá»‡n nÃ³i."
    />
    <meta
      name="keywords"
      content="há»c tiáº¿ng trung, hÃ¡n tá»±, pinyin, HSK, quiz, luyá»‡n nÃ³i"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css?v=ui2024" />
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ä¸­</text></svg>"
    />
  </head>

  <body>
    <header>
      <h1>Error</h1>
      <p class="author">The system is currently under maintenance.</p>
    </header>
    <div class="quiz">
        <header>
            <h1>Quiz HÃ¡n tá»± â†’ Pinyin</h1>
            <p class="author">TÃ¡c giáº£: BÃ¹i Giang Nam</p>
        </header>

        <main>
            <section class="dataset-section" aria-labelledby="dataset-heading">
                <h3 id="dataset-heading">Chá»n bá»™ tá»«:</h3>
                <div class="dataset-buttons" role="group" aria-label="Chá»n bá»™ tá»« vá»±ng">
                    <button class="dataset-btn" data-file="data/HSK1.csv" aria-label="Táº£i bá»™ tá»« HSK 1 vá»›i 150 tá»«">HSK 1
                        (150 tá»«)</button>
                    <button class="dataset-btn" data-file="data/HSK2.csv" aria-label="Táº£i bá»™ tá»« HSK 2 vá»›i 151 tá»«">HSK 2
                        (151 tá»«)</button>
                    <button class="dataset-btn" data-file="data/HSK3.csv" aria-label="Táº£i bá»™ tá»« HSK 3 vá»›i 296 tá»«">HSK 3
                        (296 tá»«)</button>
                    <button class="dataset-btn" data-file="data/all1-3.csv"
                        aria-label="Táº£i táº¥t cáº£ tá»« HSK 1-3 vá»›i 596 tá»«">Táº¥t cáº£ HSK 1-3 (596 tá»«)</button>
                    <button class="dataset-btn speaking-btn" data-file="data/onhsk3.txt"
                        aria-label="Cháº¿ Ä‘á»™ luyá»‡n nÃ³i HSK 3 vá»›i 76 cÃ¢u">HSK 3 NÃ³i (76 cÃ¢u)</button>
                    <button class="dataset-btn speaking-btn" data-file="data/dich.txt"
                        aria-label="Cháº¿ Ä‘á»™ Ä‘á»c dá»‹ch Viá»‡t-Trung">VIâ†’ZH (Äá»c dá»‹ch)</button>
                </div>
            </section>

            <div class="tips muted" role="note" aria-label="HÆ°á»›ng dáº«n sá»­ dá»¥ng">
                <strong>Máº¹o:</strong>
                <span id="quiz-tips">1â€“4 Ä‘á»ƒ chá»n Ä‘Ã¡p Ã¡n; Enter/Space Ä‘á»ƒ sang cÃ¢u tiáº¿p. Tráº£ lá»i sai Ä‘Æ°á»£c chá»n láº¡i.</span>
                <span id="speaking-tips" class="hidden">S Ä‘á»ƒ Ä‘á»c; Enter/Space Ä‘á»ƒ sang cÃ¢u tiáº¿p; R Ä‘á»ƒ báº­t/táº¯t random; Esc
                    Ä‘á»ƒ reset focus.</span>
            </div>

            <div id="status" class="status muted" role="status" aria-live="polite">Chá»n má»™t bá»™ tá»« Ä‘á»ƒ báº¯t Ä‘áº§u há»c.</div>

    <!-- Quiz Mode -->
    <section id="card" class="quiz-card hidden" aria-labelledby="quiz-heading">
                <h2 id="quiz-heading" class="sr-only">Cháº¿ Ä‘á»™ Quiz</h2>
                <div id="hanzi" class="hanzi" role="img" aria-label="Chá»¯ HÃ¡n cáº§n Ä‘á»c">å­—</div>
                <div id="options" class="options" role="radiogroup" aria-label="CÃ¡c lá»±a chá»n pinyin"></div>
                <div id="example" class="example muted hidden" role="region" aria-label="ThÃ´ng tin chi tiáº¿t">
                    <div><strong>NghÄ©a (VI):</strong> <span id="exMeaning"></span></div>
                    <div><strong>VÃ­ dá»¥ (chá»¯ HÃ¡n):</strong> <span id="exHanzi"></span></div>
                    <div><strong>PhiÃªn Ã¢m:</strong> <span id="exPinyin"></span></div>
                    <div><strong>Dá»‹ch:</strong> <span id="exVi"></span></div>
                </div>
                <div class="bar">
                    <div id="progress" class="muted" aria-label="Sá»‘ cÃ¢u hiá»‡n táº¡i">CÃ¢u: 0</div>
                    <div id="score" class="score" aria-label="Sá»‘ cÃ¢u tráº£ lá»i Ä‘Ãºng">ÄÃºng: 0</div>
                </div>
                <div class="quiz-controls">
                    <button id="nextBtn" class="hidden" type="button" aria-label="Chuyá»ƒn sang cÃ¢u tiáº¿p theo">CÃ¢u tiáº¿p
                        â–¶</button>
                </div>
            </section>

    <!-- Speaking Mode -->
    <section id="speaking-card" class="speaking-card hidden" aria-labelledby="speaking-heading">
                <h2 id="speaking-heading" class="sr-only">Cháº¿ Ä‘á»™ Luyá»‡n nÃ³i</h2>
                <div class="speaking-content">
                    <div id="speaking-hanzi" class="speaking-hanzi" role="img" aria-label="CÃ¢u tiáº¿ng Trung cáº§n Ä‘á»c">
                        ä½ ç°åœ¨åœ¨å“ªä¸ªåŸå¸‚ç”Ÿæ´»ï¼Ÿ</div>
                    <div id="speaking-pinyin" class="speaking-pinyin" aria-label="PhiÃªn Ã¢m pinyin">NÇ xiÃ nzÃ i zÃ i nÇge
                        chÃ©ngshÃ¬ shÄ“nghuÃ³?</div>
                    <div class="speaking-controls" role="group" aria-label="Äiá»u khiá»ƒn cháº¿ Ä‘á»™ nÃ³i">
                        <button id="speak-btn" class="speak-btn" type="button" aria-label="PhÃ¡t Ã¢m cÃ¢u tiáº¿ng Trung">ğŸ”Š
                            Äá»c</button>
                        <button id="speaking-next-btn" class="speaking-next-btn" type="button"
                            aria-label="Chuyá»ƒn sang cÃ¢u tiáº¿p theo">CÃ¢u tiáº¿p â–¶</button>
                        <button id="random-toggle-btn" class="random-toggle-btn" type="button"
                            aria-label="Báº­t/táº¯t cháº¿ Ä‘á»™ ngáº«u nhiÃªn">ğŸ² Random</button>
                        <div class="tts-rate">
                            <label for="ttsRate" class="muted">Tá»‘c Ä‘á»™:</label>
                            <input id="ttsRate" type="range" min="0.5" max="1.5" step="0.1" value="0.8"
                                aria-label="Äiá»u chá»‰nh tá»‘c Ä‘á»™ phÃ¡t Ã¢m" />
                            <span id="ttsRateValue" class="muted" aria-live="polite">0.8x</span>
                        </div>
                        <button id="viZhBtn" class="speak-btn hidden" type="button"
                            aria-label="PhÃ¡t Ã¢m tiáº¿ng Viá»‡t rá»“i tiáº¿ng Trung">â–¶ VIâ†’ZH</button>
                        <label class="autoplay-label">
                            <input id="autoplayToggle" type="checkbox" aria-label="Tá»± Ä‘á»™ng phÃ¡t Ã¢m" />
                            <span class="muted">Tá»± Ä‘á»™ng phÃ¡t</span>
                        </label>
                    </div>
                </div>
                <div class="speaking-bar">
                    <div id="speaking-progress" class="muted" aria-label="Sá»‘ cÃ¢u hiá»‡n táº¡i">CÃ¢u: 0</div>
                    <div class="speaking-mode-indicator" aria-label="Cháº¿ Ä‘á»™ hiá»‡n táº¡i">ğŸ“¢ Cháº¿ Ä‘á»™ nÃ³i</div>
                </div>
            </section>
        </main>
    </div>

    <script src="version.js"></script>
    <script src="script.js?v=ui2024"></script>
    <script src="random-fix.js?v=ui2024"></script>
    <script>
      // Debug script
      setTimeout(() => {
        console.log("=== DEBUG SCRIPT ===");
        console.log("Environment:", {
          hostname: window.location.hostname,
          protocol: window.location.protocol,
          pathname: window.location.pathname,
        });

        const randomBtn = document.getElementById("random-toggle-btn");
        console.log("Random button found:", !!randomBtn);
        if (randomBtn) {
          console.log("Button text:", randomBtn.textContent);
          console.log("Button styles:", {
            background: window.getComputedStyle(randomBtn).background,
            cursor: window.getComputedStyle(randomBtn).cursor,
            pointerEvents: window.getComputedStyle(randomBtn).pointerEvents,
            zIndex: window.getComputedStyle(randomBtn).zIndex,
          });

          // No manual handlers - let random-fix.js handle everything

          console.log("Manual click handler added");
        }

        // Check if script.js loaded properly
        console.log("Script.js functions available:", {
          loadDataset: typeof window.loadDataset,
          nextSpeakingQuestion: typeof window.nextSpeakingQuestion,
          toggleRandomMode: typeof window.toggleRandomMode,
        });

        // Test random functionality directly
        window.testRandom = function () {
          console.log("=== TEST RANDOM FUNCTION ===");
          console.log(
            "Current speaking data length:",
            window.speakingData ? window.speakingData.length : "undefined"
          );
          console.log("Current speaking index:", window.speakingIndex);
          console.log("Is random mode:", window.isRandomMode);

          if (window.speakingData && window.speakingData.length > 0) {
            const randomIndex = Math.floor(
              Math.random() * window.speakingData.length
            );
            console.log("Random index would be:", randomIndex);
            console.log(
              "Random question would be:",
              window.speakingData[randomIndex]
            );
          }
        };

        // Test speaking next button directly
        window.testSpeakingNext = function () {
          console.log("=== TEST SPEAKING NEXT ===");
          const speakingNextBtn = document.getElementById("speaking-next-btn");
          console.log("Speaking next button found:", !!speakingNextBtn);
          if (speakingNextBtn) {
            console.log("Clicking speaking next button...");
            speakingNextBtn.click();
          }
        };

        console.log(
          "Test functions added: window.testRandom() and window.testSpeakingNext()"
        );
      }, 1000);
    </script>
  </body>
</html>
